<!DOCTYPE html>
<html lang="en">
<head>
    <title>Kenny Lam - GSoC 2023</title>
    <link rel="icon" type="image/x-icon" href="/imgs/favicon.png">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>


    <!-- JavaScript Bundle with Popper -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!--    <link href="css/bootstrap.min.css" rel="stylesheet">-->
    <!--    <script src="js/bootstrap.bundle.min.js"></script>-->
    <script src="
https://cdn.jsdelivr.net/npm/echarts@5.4.1/dist/echarts.min.js
"></script>
</head>
<style>
    #myBtn {
        display: block;
        position: fixed;
        bottom: 20px;
        right: 30px;
        z-index: 99;
        font-size: 18px;
        border: none;
        outline: none;
        background-color: #aaa;
        cursor: pointer;
        padding: 15px;
        width: 50px;  /* Set the width */
        height: 50px;  /* Set the height */
        border-radius: 50%;  /* Make the border radius half of the width/height */
    }

    #myBtn:hover {
        background-color: #555;
    }
</style>
<style>
    body, html {
        height: 100%;
        position: relative;
        overflow: auto;
        scroll-behavior: smooth;
    }

    .nav-link {
        font-weight: 400;
        font-size: 15px;
        font-family: "Libre Franklin", "Helvetica Neue", helvetica, arial, sans-serif;
        line-height: 1.8;
        color: #C9C9C9FF;
    }

    .nav-item{
        font-weight: 400;
        font-size: 15px;
        font-family: "Libre Franklin", "Helvetica Neue", helvetica, arial, sans-serif;
        line-height: 1.8;
        color: #C9C9C9FF;
        padding: 5px;
    }


    .site-header {
        background-color: rgba(0, 0, 0, .85);
        -webkit-backdrop-filter: saturate(180%) blur(20px);
        backdrop-filter: saturate(180%) blur(20px);
    }
    .site-header a {
        color: #999;
        transition: ease-in-out color .15s;
    }
    .site-header a:hover {
        color: #fff;
        text-decoration: none;
    }

    /*
     * Dummy devices (replace them with your own or something else entirely!)
     */

    .product-device {
        position: absolute;
        right: 10%;
        bottom: -30%;
        width: 300px;
        height: 540px;
        background-color: #333;
        border-radius: 21px;
        -webkit-transform: rotate(30deg);
        transform: rotate(30deg);
    }

    .product-device::before {
        position: absolute;
        top: 10%;
        right: 10px;
        bottom: 10%;
        left: 10px;
        content: "";
        background-color: rgba(255, 255, 255, .1);
        border-radius: 5px;
    }

    .product-device-2 {
        top: -25%;
        right: auto;
        bottom: 0;
        left: 5%;
        background-color: #e5e5e5;
    }
    .green-highlight, .pink-highlight, .yellow-highlight {
        -webkit-border-radius: 5px;
        -moz-border-radius: 5px;
        border-radius: 5px;
        padding-left: 3px;
    }
    .pink-highlight {
        background: #FFCCFF; /* Default color, all browsers */
    }

    .pink-highlight::selection {
        background: #FF99FF; /* Selection color, WebKit/Blink Browsers */
    }

    .pink-highlight::-moz-selection {
        background: #FF99FF; /* Selection color, Gecko Browsers */
    }


    /*
     * Extra utilities
     */

    .border-top { border-top: 1px solid #e5e5e5; }
    .border-bottom { border-bottom: 1px solid #e5e5e5; }

    .box-shadow { box-shadow: 0 .25rem .75rem rgba(0, 0, 0, .05); }

    .flex-equal > * {
        -ms-flex: 1;
        -webkit-box-flex: 1;
        flex: 1;
    }
    @media (min-width: 768px) {
        .flex-md-equal > * {
            -ms-flex: 1;
            -webkit-box-flex: 1;
            flex: 1;
        }
    }

    @media (min-width: 580px) {
        .navbar {
            height: 60px;
        }
    }

    .overflow-hidden { overflow: hidden; }

    th, td {
        padding: 5px;
    }

    table, th, td {
        border: 1px solid black;
    }
</style>
<style>
    a.anchor{display: block; position: relative; top: -70px; visibility: hidden;}
</style>
<body>
<i onclick="topFunction()" id="myBtn" title="Go to top" class="fa-solid fa-angles-up" style="color: #000000; padding: 15px; text-align: center;"></i>

<nav class="navbar navbar-dark bg-dark navbar-expand-sm bg-body-tertiary sticky-top" >
    <div class="container-fluid">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon" ></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
            <ul class="navbar-nav me-auto ms-auto">
                <!--                    <li class="nav-item">-->
                <!--                            <a class="nav-link popup" onclick="myFunction()"  href="../../#"><i class="fa-solid fa-envelope" style="color: white;font-size:35px"></i>-->
                <!--                                <span class="popuptext" id="myPopup">Copied</span>-->
                <!--                            </a>-->
                <!--                    </li>-->
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/kennylam8" target="_blank"><i class="fa-brands fa-github" style="color: white;font-size:35px"></i></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://www.linkedin.com/in/kenny-lam8/" target="_blank"><i class="fa-brands fa-linkedin" style="color: white;font-size:35px"></i></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://www.linkedin.com/in/kenny-lam8/" target="_blank"><i class="fa-brands fa-twitter" style="color: white;font-size:35px"></i></a>
                </li>
            </ul>
            <ul class="navbar-nav me-auto ms-auto">
                <li class="nav-item">
                    <a class="nav-link" href="../../index.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../#about" data-toggle="collapse" data-target=".navbar-collapse.show">About</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../#skills">Skills</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../#experience_all">Experience</a>
                </li>
                <li class="nav-item">
                    <a href="../../#projects" class="nav-link">Projects</a>
                </li>
                <li class="nav-item">
                    <a href="../../#contact" class="nav-link">Contact</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container">

    <br/>
    <h1 id="google-summer-of-code-2023-br-differentiating-real-and-misaligned-introns-with-machine-learning">Google Summer of Code 2023: <br/> Differentiating Real and Misaligned Introns with Machine Learning</h1>
    <p><img src="https://img.shields.io/badge/Licence-MIT-blue" alt="Static Badge">
        <img src="https://img.shields.io/badge/Python-3.10-orange" alt="Static Badge">
        <a href="https://github.com/EnsemblGSOC/IntronOrNot/releases/tag/v0.1.0-alpha"><img src="https://img.shields.io/badge/Release-0.0.1--alpha-red" alt="Static Badge"></a></p>
    <p>To address issue that strict filters rejects most of the legitimate introns,
        we developed IntronOrNot (ION) - a machine learning to differentiate that predicts
        if the intron is real or misaligned. The model accepts coordinates, .bed, and .gtf file as input.
        The prediction script is easy to use and achieved comparable results
        to sequenced-based deep learning intron predictor. A standalone function
        that extracts intron from .gtf is also included.</p>

    <h1 id="work-done">Work Done</h1>
    <p>All the work done in this project including all the commits can be found at:
        <br/><a target="blank" href="https://github.com/kennylam8/IntronOrNot/">https://github.com/kennylam8/IntronOrNot/</a><br/>
        <a target="blank" href="https://github.com/EnsemblGSOC/IntronOrNot">https://github.com/EnsemblGSOC/IntronOrNot</a></p>

    <p>The latest commit as of the submission of the GSoC final evaluation is: <a target="blank" href="https://github.com/EnsemblGSOC/IntronOrNot/commit/5db1ff6c72fa89a11e8d66d1d69bcd66188740eb">5db1ff6</a></p>
    <p>We documented the process of testing and building the model using Jupyter-Notebooks, all the notebooks can be found at the root directory of the Github repository</p>
    <h1 id="table-of-contents">Table of Contents</h1>
    <ul>
    <li><a href="#organisation">Organisation &amp; Mentors</a></li>
    <li><a href="#getting-started">Getting Started</a><ul>
      <li><a href="#usage">Usage</a></li>
    </ul>
    </li>
    <li><a href="#background">Background</a><ul>
      <li><a href="#goal">Project Goal</a></li>
    </ul>
    </li>
    <li><a href="#training-set">Training Set Preparation</a><ul>
      <li><a href="#pos-trainset">Positive Class Data</a></li>
      <li><a href="#neg-trainset">Negative Class Data</a></li>
    </ul>
    </li>
    <li><a href="#feature-eng">Feature Engineering</a><ul>
      <li><a href="#feature-tested">Features Tested</a></li>
      <li><a href="#feature-selection">Feature Selection</a></li>
    </ul>
    </li>
    <li><a href="#ml-model">Machine Learning Model</a><ul>
      <li><a href="#model-arc">Model Architecture</a></li>
      <li><a href="#hyperparam-opt">Hyperparameter Optimisation</a></li>
      <li><a href="#model-training">Training</a></li>
      <li><a href="#model-eval">Evaluation Metrics</a></li>
      <li><a href="#shap">Feature Importance using SHAP (SHapley Additive exPlanations)</a></li>
      <li><a href="#pred-expl">Prediction Explanation</a></li>
    </ul>
    </li>
    <li><a href="#results">Results</a><ul>
      <li><a href="#cross-val">10-Fold Stratified Cross Validation</a></li>
      <li><a href="#external-val">External Validation &amp; Benchmark</a></li>
      <li><a href="#test-summary">Summary</a></li>
    </ul>
    </li>
    <li><a href="#challenges-limitation-and-future-work">Challenges, Limitations, and Future Work</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#remarks">Acknowledgements and Remarks</a></li>
    </ul>
    <a target="blank" class="anchor" id="organisation"></a>
    <h1>Organisation &amp; Mentors</h1>
    <p>Genome Assembly and Annotation (European Bioinformatics Institute / EMBL-EBI)</p>
    <h3 id="research-group">Research Group</h3>
    <p>Ensembl - <a target="blank" href="https://www.ebi.ac.uk/about/teams/genome-interpretation/">Genome Interpretation Teams</a></p>
    <h3 id="mentors">Mentors</h3>
    <p><a target="blank" href="https://www.ebi.ac.uk/people/person/jose-manuel-gonzalez-martinez/">Jose Gonzalez</a><br/>
        <a target="blank" href="https://www.ebi.ac.uk/people/person/jonathan-mudge/">Jonathan Mudge</a><br/>
        <a target="blank" href="https://www.ebi.ac.uk/people/person/adam-frankish/">Adam Frankish</a></p>
    <h1 id="graphical-abstract" >Graphical Abstract</h1>
    <p><img src="gsoc-2023-imgs/ga.png" style="height: auto; width: 100%" alt=""></p>
    <p style="text-align: right;">Created with BioRender.com</p>
    <br/>
    <h1><a target="blank" class="anchor" id="getting-started"></a>Getting Started</h1>
    <h3 id="installation">Installation</h3>
    <ul>
        <li>Download the latest zipped script in <code>Releases</code></li>
        <li>Install the required dependencies detailed below</li>
    </ul>
    <h3 id="-a-name-enviroment-a-environment"><a target="blank" class="anchor" id="enviroment"></a>Environment</h3>
    <ul>
        <li>32 GB of RAM or more is required for a large .bed file</li>
        <li>Multi-thread support is default to enabled with the Pandarallel library</li>
    </ul>
    <h3 id="-a-name-package-req-a-package-requirements"><a target="blank" class="anchor" id="package-req"></a>Package Requirements</h3>
    <p><strong>Please Note that this requirement is for the final ION script in <code>Releases</code>, not the notebooks</strong>\
        <br/>
    <details>
        <summary>View enviroment.yml</summary>
        <pre>name: ion
channels:
  - conda-forge
  - bioconda
  - defaults
dependencies:
  - _libgcc_mutex=0.1
  - _openmp_mutex=4.5
  - bzip2=1.0.8
  - ca-certificates=2023.7.22
  - ld_impl_linux-64=2.40
  - libffi=3.4.2
  - libgcc-ng=13.2.0
  - libgomp=13.2.0
  - libnsl=2.0.0
  - libsqlite=3.43.0
  - libuuid=2.38.1
  - libzlib=1.2.13
  - ncurses=6.4
  - openssl=3.1.2
  - pip=23.2.1
  - python=3.10.12
  - readline=8.2
  - setuptools=68.2.2
  - tabix=0.2.6
  - tk=8.6.12
  - wheel=0.41.2
  - xz=5.2.6
  - zlib=1.2.13
  - pip:
    - bcbio-gff==0.7.0
    - biopython==1.81
    - cloudpickle==2.2.1
    - contourpy==1.1.1
    - cycler==0.11.0
    - dill==0.3.7
    - fonttools==4.42.1
    - joblib==1.3.2
    - kiwisolver==1.4.5
    - llvmlite==0.40.1
    - matplotlib==3.8.0
    - numba==0.57.1
    - numpy==1.24.4
    - packaging==23.1
    - pandarallel==1.6.5
    - pandas==1.5.3
    - pillow==10.0.1
    - psutil==5.9.5
    - pybigwig==0.3.22
    - pyfaidx==0.7.2.1
    - pyparsing==3.1.1
    - python-dateutil==2.8.2
    - pytz==2023.3.post1
    - scikit-learn==1.1.1
    - scipy==1.11.2
    - shap==0.42.1
    - six==1.16.0
    - slicer==0.0.7
    - threadpoolctl==3.2.0
    - tqdm==4.66.1
    - tzdata==2023.3
    - xgboost==1.6.2
</pre>
    </details>
    <h2 id="-a-name-usage-a-usage"><a target="blank" class="anchor" id="usage"></a>Usage</h2>
    <p>Coordinate mode (1-based):</p>
    <code>python3 ION.py --mode high-precision --type coord chr3 83979030 83990643 +</code>

    <p><br/>BED mode:</p>
    <code> python3 ION.py --mode high-precision --type bed --file examples/example.bed</code>
    <p><br/>GTF mode:</p>
    <code>python3 ION.py --mode high-precision --type gtf --file examples/example.gtf</code>
    <p><br/>IMPORTANT: ION can only evaluate intorns with canonical splice-site (GT:AG, GC:AG, AT:AC)</p>
    <h1 id="-a-name-background-a-background"><a target="blank" class="anchor" id="background"></a>Background</h1>
    <p>Understanding the impact of genetic variation on disease requires comprehensive gene annotation.
        Human genes are well characterised following more than two decades of work on their annotation, however,
        we know that this annotation is not complete and that new experimental methods are generating data
        to help us towards the goal of complete gene annotation.</p>
    <p>The advancement in the accuracy of long-read sequencing technology has allowed us to explore novel transcript variants of known genes.
        Preventing potentially wrong transcripts and gene annotation is essential to the science community as many rely on the annotation for decision-making.
        Automated workflow with a has been developed to minimise the time needed to verify and annotated those transcript variants. However,
        current workflows are developed using a very strict rule-set and hence many of the novel transcript variants were rejected.
        This project aims to address this issue by using machine learning to differentiate good quality but rejected transcripts,
        using it as a standalone classification filter or analysing the decision-making methods of the model and consequently
        improving the rule-set used in the automated workflow.</p>
    <p>You can read more about the background of this project at: <a target="blank" href="https://github.com/jmgonzmart/GSoC_ML_gene_annot">https://github.com/jmgonzmart/GSoC_ML_gene_annot</a></p>
    <h2 id="-a-name-goal-a-project-goal"><a target="blank" class="anchor" id="goal"></a>Project Goal</h2>
    <p>This project consists of the following deliverables and goals:</p>
    <ul>
        <li>Install/prepare the environment and repository for the project.</li>
        <li>Extract the GENCODE annotation data and featurize them into tabular format.</li>
        <li>Explore the addition of other features that might facilitate decision-making or machine learning
            model.</li>
        <li>Learn to generate an extended set of low-quality transcript or splice junction predictions.</li>
        <li>Develop a machine learning model that differentiate misaligned and real introns. The model should have low false positive rate.</li>
        <li>Perform and document the statistical analysis of the model to extract its most relevant features for
            decision-making.</li>
        <li>Run the final model on novel transcripts and produce a detailed report of the results.</li>
    </ul>
    <h1 id="-a-name-training-set-a-training-set-preparation"><a target="blank" class="anchor" id="training-set"></a>Training Set Preparation</h1>
    <h2 id="-a-name-pos-trainset-a-positive-class-data"><a target="blank" class="anchor" id="pos-trainset"></a>Positive Class Data</h2>
    <p>Relevant Notebook: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/01_extract_introns_from_gencode.ipynb">01</a></p>
    <p>We used the GENCODE v44 (<a target="blank" href="https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_44/">https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_44/</a>) as our positive set. We
        used a script to extract all the introns out of the .gtf file.</p>
    <h2 id="-a-name-neg-trainset-a-negative-class-data"><a target="blank" class="anchor" id="neg-trainset"></a>Negative Class Data</h2>
    <p>Relevant Notebook: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/02_extract_negative_introns.ipynb">02</a>, <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/03_generating_false_introns.ipynb">03</a>, <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/04_combining_positive_and_negative_train_set.ipynb">04</a></p>
    <p>We used two source for generating negative class data.</p>
    <ul>
        <li><p>We have access to a previous gene annotators&#39; manually reviewed data, the dataset contains ~11000 introns, after removing introns that are already accepted in current version, 403 negative introns were obtained.</p>
        </li>
        <li><p>To simulate how false intron data could be presented in real data, we ultilized <a target="blank" href="https://academic.oup.com/nargab/article/4/4/lqac092/6855700">PBSIM3</a> (Ono et al., 2022), a simulator for long-read sequencers that
            is capable to simulate both PacBio RS II continuous long reads (CLR) and Oxford Nanopore Technology (ONT) reads. We simulated the reads using GENCODE v44 <code>Long non-coding RNA transcript sequences</code> and <code>Protein-coding transcript sequences</code> RNA data. We simulated them using four different settings:</p>
            <ul>
                <li>ONT single pass - protein coding genes</li>
                <li>ONT multi-pass - protein coding genes</li>
                <li>PacBio Iso-seq - protein coding genes</li>
                <li>ONT single pass - lcnRNA</li>
            </ul>
        </li>
    </ul>
    <p>The reads were then aligned to the human genome respectively using <a target="blank" href="https://doi.org/10.1093/bioinformatics/bty191">Minimap2</a> (Li, 2018), and intronic regions of all alignments were then extracted and
        compared against the current GENCODE annotation and those that were not in the current GENCODE annotation is treated as false/misaligned introns.
        About 110,000 false introns were obtained.</p>
    <h1 id="-a-name-feature-eng-a-feature-engineering"><a target="blank" class="anchor" id="feature-eng"></a>Feature Engineering</h1>
    <h2 id="-a-name-feature-tested-a-features-tested"><a target="blank" class="anchor" id="feature-tested"></a>Features Tested</h2>
    <p>9 categories of features were generated:</p>
    <ul>
        <li>Recount3 score: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/05_recount3_feature.ipynb">Notebook 05</a><ul>
            <li>Based on the data extracted from the intronic region of <code>recount3: summaries and queries for large-scale RNA-seq expression and splicing</code> (Wilks et al.)</li>
        </ul>
        </li>
        <li>Repeat region: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/06_repeat_region_feature.ipynb">Notebook 06</a><ul>
            <li>Check if any of the splice-sites lies in repeating regions.</li>
        </ul>
        </li>
        <li>Antisense Exon: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/07_antisense_feature.ipynb">Notebook 07</a></li>
        <li>Distance of next nearest existing splice-site: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/09_nearest_alternative_splice_site_distance_feature.ipynb">Notebook 09</a><ul>
            <li>Check the coordinate of both the donor and acceptor splice-site against current annotation (GENCODE v44) and calculate the distance between the splice site and the closest annotated splice-site nearby (excluding exact match).</li>
        </ul>
        </li>
        <li>MaxEntScan score: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/10_maxentscan_score_feature.ipynb">Notebook 10</a><ul>
            <li>Based on the script/methodology developed by Yeo and Burge - <code>Maximum entropy modeling of short sequence motifs with applications to RNA splicing signals</code></li>
        </ul>
        </li>
        <li>Basic sequence based feature: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/11_basic_sequence_features.ipynb">Notebook 11</a><ul>
            <li>The process of pairing the sequence with the introns could be found in <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/08_pairing_with_hg38.ipynb">Notebook 08</a></li>
            <li>Calculates the GC content.</li>
            <li>Determines whether the sequence can be considered a CpG island based on the ratio of CpG dinucleotides and the GC content in the sequence.</li>
            <li>Calculates the intron length.</li>
        </ul>
        </li>
        <li>Conservation scores: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/12_conservation_scores_feature.ipynb">Notebook 12</a><ul>
            <li>Calculate the splice-site conservation scores with the <a target="blank" href="https://doi.org/10.1101/gr.3715005">PhastCon</a> and <a target="blank" href="https://doi.org/10.1101%2Fgr.097857.109">PhyloP</a> conservation resources downloaded from the <a target="blank" href="https://doi.org/10.1093%2Fbib%2Fbbs038">UCSC genome browser</a>.</li>
        </ul>
        </li>
        <li>Splice-site with better Recount3 score nearby: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/13_recount3_near_ss_with_better_score_feature.ipynb">Notebook 13</a><ul>
            <li>We look at 5nt further at both direction of the splice-site and see if there is a splice-site recorded in recount3 that has a better score</li>
        </ul>
        </li>
        <li>Branch Point Prediction (BPP) score: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/14_BPP_prediction_feature.ipynb">Notebook 14</a><ul>
            <li>Branch point prediction using <a target="blank" href="https://doi.org/10.1093/bioinformatics/btx401">BPP</a> (Zhang el al.)</li>
        </ul>
        </li>
    </ul>
    <h2 id="-a-name-feature-selection-a-feature-selection"><a target="blank" class="anchor" id="feature-selection"></a>Feature Selection</h2>
    <p>Relevant Notebook: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/17_feature_selection.ipynb">17</a></p>
    <p>To make the model easier to interpret, and improve its performance. We simplify the model using feature selection.</p>
    <p>We intentionally drop some features that we learned from empirical knowledge from the annotators are unimportant, namely the strand and chromosome of the introns.</p>
    <p>We performed feature selection using RFECV:
        Recursive Feature Elimination with Cross-Validation (RFECV) is a feature selection technique that aims to identify
        a subset of features that are most useful for making accurate predictions. It is an extension of Recursive Feature
        Elimination (RFE), which eliminates feature one by one according to their validation performance, RFECV incorporates
        cross-validation (5-fold were chosen) for evaluation.</p>
    <p>We also dropped the <code>sc</code> feature which is generated by the BPP script, as it has relatively less importance (reflected by the RFECV result) and not easily interpretable, and also introns lesser than certain length could not obtain the <code>sc</code> feature, we decided to remove it. </p>
    <p>24 features were chosen. Refer to the second last cell of <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/17_feature_selection.ipynb">Notebook 17</a> for more details.</p>
    <h1 id="-a-name-ml-model-a-machine-learning-model"><a target="blank" class="anchor" id="ml-model"></a>Machine Learning Model</h1>
    <h2 id="-a-name-model-arc-a-model-architecture"><a target="blank" class="anchor" id="model-arc"></a>Model Architecture</h2>
    <p>We have tested different model architecture including Explainable Boosting Machine (EBM), RandomForest (RF), and more. We
        chose XGBoost as the model for this task for its good performance in internal validation.</p>
    <h2 id="-a-name-hyperparam-opt-a-hyperparameter-optimisation"><a target="blank" class="anchor" id="hyperparam-opt"></a>Hyperparameter Optimisation</h2>
    <p>Relevant Notebook: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/18_hyperparameter_optimisation.ipynb">18</a></p>
    <p>We chose the hyperparameter the XGBoost model using exhaustive grid searching with 3-fold cross-validation of the following parameter:</p>
    <pre><code>parameter_grid = {
    <span class="hljs-string">'n_estimators'</span>: [<span class="hljs-number">50</span>, <span class="hljs-number">100</span>, <span class="hljs-number">150</span>, <span class="hljs-number">200</span>],
    <span class="hljs-string">'learning_rate'</span>: [<span class="hljs-number">0.01</span>, <span class="hljs-number">0.1</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">0.3</span>],
    <span class="hljs-string">'max_depth'</span>: [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>],
    <span class="hljs-string">'min_child_weight'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>],
    <span class="hljs-string">'subsample'</span>: [<span class="hljs-number">0.8</span>, <span class="hljs-number">0.9</span>, <span class="hljs-number">1.0</span>],
    <span class="hljs-string">'colsample_bytree'</span>: [<span class="hljs-number">0.8</span>, <span class="hljs-number">0.9</span>, <span class="hljs-number">1.0</span>]
}
</code></pre><p>The best parameters were combinations with <code>learning_rate = 0.1</code>, however after consideration our model has limited
    training data, a learning rate with 0.1 will have a potential problem of overfitting, after evaluating different
    combinations with internal validation, we opted to use <code>{&#39;colsample_bytree&#39;: 0.9, &#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 7, &#39;min_child_weight&#39;: 1, &#39;n_estimators&#39;: 200, &#39;subsample&#39;: 0.8}</code>,
    which is the highest combination with <code>learning_rate = 0.01</code>.</p>
    <h2 id="-a-name-model-training-a-training"><a target="blank" class="anchor" id="model-training"></a>Training</h2>
    <p>Relevant Notebook: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/19a_standard_model_building.ipynb">19a</a>, <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/19b_strict_model_building.ipynb">19b</a>, <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/19c_high_precision_model_building.ipynb">19c</a></p>
    <p>We trained three separate model with the same parameter except for the <code>scale_pos_weight</code>. According to the xgboost
        documentation, it &quot;control the balance of positive and negative weights, useful for unbalanced classes. A typical value
        to consider: sum(negative instances) / sum(positive instances)&quot;, after internal cross-validation, we settled on: </p>
    <ul>
        <li><strong>High-Recall Mode</strong><ul>
            <li><code>scale_pos_weight = sum(negative instances) / sum(positive instances)</code></li>
        </ul>
        </li>
        <li><strong>Standard Mode</strong><ul>
            <li><code>scale_pos_weight = sum(negative instances) / sum(positive instances) / 2</code></li>
        </ul>
        </li>
        <li><strong>High-Precision Mode</strong><ul>
            <li><code>scale_pos_weight = sum(negative instances) / sum(positive instances) / 4</code></li>
        </ul>
        </li>
    </ul>
    <h2 id="-a-name-model-eval-a-evaluation-metrics"><a target="blank" class="anchor" id="model-eval"></a>Evaluation Metrics</h2>
    <p>The model&#39;s performance should be evaluated using metrics that consider both classes, metrics such as MCC should be emphasised.
        We will evaluate our model using these metrics:</p>
    <ul>
        <li>Matthews Correlation Coefficient (MCC)</li>
        <li>Accuracy (Acc)</li>
        <li>Balanced Accuracy (BAcc)</li>
        <li>Precision</li>
        <li>Recall</li>
        <li>False Positive Rate (FPR)<ul>
            <li>This is espicially important because we need to ensure the model does not produce false positive</li>
        </ul>
        </li>
        <li>Area Under Receiver Operating Characteristic Curve (AUROC)</li>
    </ul>
    <h2 id="-a-name-shap-a-feature-importance-using-shap-shapley-additive-explanations-"><a target="blank" class="anchor" id="shap"></a>Feature Importance using SHAP (SHapley Additive exPlanations)</h2>
    <p>One of the primary objectives of this project is to gain a deeper understanding of the significance of various features,
        knowledge that could be leveraged to enhance existing filters. Gaining insights into the model&#39;s performance is not merely beneficial but crucial.
        A more interpretable model could substantially contribute to more informed and effective decision-making processes.</p>
    <p>We sampled 50% of the data (~240k entries) to examine the overall importance of features and how the value of features are affecting the model.\
        The color reflects the value of the feature, the order of the features (vertically) is the importance of it, and the x-axis reflects
        the impact on the model (SHAP value).</p>
    <p><img src="gsoc-2023-imgs/shap_comparison.png" style="height: auto; width: 100%" alt="">
        <img src="gsoc-2023-imgs/shap_comparison_2.png" style="height: auto; width: 100%" alt="">
        We can see that recount3 score is the most important feature and from the first plot we can see that the model
        definitely favours entries with high recount3 score. One interesting finding is that phyloP or the phastCon score
        is also an important feature, as it was not incorporated in the original filters used by the annotation team, this
        could also be considered.</p>
    <h2 id="-a-name-pred-expl-a-prediction-explanation"><a target="blank" class="anchor" id="pred-expl"></a>Prediction Explanation</h2>
    <p>You can export and view the explanation for the prediction using <code>--shap true</code> option, it is also defaulted to true in coordinates mode</p>
    <h3 id="example-plot-">Example plot:</h3>
    <p><img src="gsoc-2023-imgs/example_waterfall_explanation.png" style="height: auto; width: 100%" alt=""></p>
    <h1 id="-a-name-results-a-results"><a target="blank" class="anchor" id="results"></a>Results</h1>
    <p>Relevant Notebook: <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/20a_external_benchmarking.ipynb">20a</a>, <a target="blank" href="https://github.com/kennylam8/IntronOrNot/blob/main/20b_external_benchmarking_gencode.ipynb">20b</a></p>
    <h2 id="-a-name-cross-val-a-10-fold-stratified-cross-validation"><a target="blank" class="anchor" id="cross-val"></a>10-Fold Stratified Cross Validation</h2>
    <p>Standard Deviation (SD) of the folds are presented as the value after ±, only the first s.f. are shown in SD.</p>
    <table>
        <thead>
        <tr>
            <th></th>
            <th>Accuracy</th>
            <th>B. Accuracy</th>
            <th>FPR</th>
            <th>MCC</th>
            <th>AUROC<sub>score</sub></th>
            <th>Precision</th>
            <th>Recall</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>ION (High-Recall Mode)</td>
            <td>0.949</td>
            <td>0.937</td>
            <td>0.083</td>
            <td>0.836</td>
            <td>0.980</td>
            <td>0.982</td>
            <td>0.956</td>
        </tr>
        <tr>
            <td>ION (Standard Mode)</td>
            <td>0.933</td>
            <td>0.933</td>
            <td>0.068</td>
            <td>0.800</td>
            <td>0.980</td>
            <td>0.984</td>
            <td>0.933</td>
        </tr>
        <tr>
            <td>ION (High-Precision Mode)</td>
            <td>0.894</td>
            <td>0.917</td>
            <td>0.046</td>
            <td>0.722</td>
            <td>0.980</td>
            <td>0.989</td>
            <td>0.881</td>
        </tr>
        </tbody>
    </table>
    <p>We can see that adjusting the <code>scale_pos_weight</code> parameter of the model allows us to lower to FPR (while sacrificing the overall predictive performance (indicated by MCC and Recall))</p>
    <h2 id="-a-name-external-val-a-external-validation-benchmark"><a target="blank" class="anchor" id="external-val"></a>External Validation &amp; Benchmark</h2>
    <h3 id="manually-annotated-lncrna-test-set">Manually annotated lncRNA test-set</h3>
    <table>
        <thead>
        <tr>
            <th></th>
            <th>Acc</th>
            <th>B. Acc</th>
            <th>FPR</th>
            <th>MCC</th>
            <th>AUROC<sub>score</sub></th>
            <th>Precision</th>
            <th>Recall</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>ION (High-Recall Mode)</td>
            <td><strong>0.860</strong></td>
            <td>0.724</td>
            <td>0.443</td>
            <td><strong>0.361</strong></td>
            <td><strong>0.858</strong></td>
            <td>0.952</td>
            <td><strong>0.890</strong></td>
        </tr>
        <tr>
            <td>ION (Standard Mode)</td>
            <td>0.742</td>
            <td><strong>0.784</strong></td>
            <td>0.165</td>
            <td>0.351</td>
            <td>0.851</td>
            <td>0.978</td>
            <td>0.732</td>
        </tr>
        <tr>
            <td>ION (High-Precision Mode)</td>
            <td>0.429</td>
            <td>0.673</td>
            <td><strong>0.028</strong></td>
            <td>0.210</td>
            <td>0.855</td>
            <td><strong>0.992</strong></td>
            <td>0.374</td>
        </tr>
        <tr>
            <td>Filters (Intropolis)</td>
            <td>0.366</td>
            <td>0.633</td>
            <td>0.040</td>
            <td>0.171</td>
            <td>0.633</td>
            <td>0.987</td>
            <td>0.306</td>
        </tr>
        <tr>
            <td>Filters (Recount3)</td>
            <td>0.701</td>
            <td>0.654</td>
            <td>0.403</td>
            <td>0.191</td>
            <td>0.654</td>
            <td>0.946</td>
            <td>0.711</td>
        </tr>
        <tr>
            <td>SPLAM<sup>1</sup></td>
            <td>0.483</td>
            <td>0.674</td>
            <td>0.091</td>
            <td>0.205</td>
            <td>0.831</td>
            <td>0.674</td>
            <td>0.674</td>
        </tr>
        </tbody>
    </table>
    <ol>
        <li>True if both Donor score and Acceptor score &gt;= 0.5 else false, actual predicted value is calculated by using the min(donor_score, acceptor_score).</li>
    </ol>
    <h3 id="gencode-v46-newly-added-introns">GENCODE v46 Newly Added Introns</h3>
    <p>As only single class is available (accepted/positive), only accuracy is included</p>
    <table>
        <thead>
        <tr>
            <th></th>
            <th>Accuracy</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>ION (High-Recall mode)</td>
            <td><strong>0.844</strong></td>
        </tr>
        <tr>
            <td>ION (Standard Mode)</td>
            <td>0.708</td>
        </tr>
        <tr>
            <td>ION (High-Precision Mode)</td>
            <td>0.601</td>
        </tr>
        <tr>
            <td>SPLAM<sup>1</sup></td>
            <td>0.772</td>
        </tr>
        </tbody>
    </table>
    <ol>
        <li>True if both Donor score and Acceptor score &gt;= 0.5 else false</li>
    </ol>
    <h2 id="-a-name-test-summary-a-summary"><a target="blank" class="anchor" id="test-summary"></a>Summary</h2>
    <p>Table 1 provides a comparative evaluation of different machine learning models designed to classify long non-coding
        RNAs (lncRNAs) based on a manually annotated test set. Among the models, ION in High-Recall Mode stands out for its superior
        performance across multiple metrics: it boasts the highest accuracy (0.860), Matthews Correlation Coefficient (0.361), and
        AUROC score (0.858). It also excels in recall with a rate of 0.890, suggesting that it is particularly effective at correctly
        identifying positive cases. However, this high recall comes at the expense of a higher False Positive Rate (FPR) of 0.443,
        indicating that the model also incorrectly classifies a considerable number of negative cases as positive.
    </p>
    <p>ION in Standard Mode achieves the highest Balanced Accuracy of 0.784 and maintains a relatively low FPR of 0.165,
        offering a balanced performance between sensitivity and specificity. ION in High-Precision Mode excels in precision
        with a score of 0.992 and has the lowest FPR of 0.028, but lags in recall and overall accuracy. Filters (Intropolis)
        and Filters (Recount3) generally perform lower across most metrics, while SPLAM<sup>1</sup> shows moderate results.
        Each model appears to have its strengths and weaknesses, providing options to choose based on the specific requirements
        of an lncRNA classification task.</p>
    <p>Table 2 provides comparison of models. As only accepted data are available in GENCODE, we can only compare their accuracy,
        we can see that the high-recall mode of ION has the best accuracy, while other both the standard and high-precision mode suffered
        from relatively low accuracy compared to SPLAM, which achieved 77.2%.</p>
    <h1 id="-a-name-challenges-limitation-and-future-work-a-challenges-limitations-and-future-work"><a target="blank" class="anchor" id="challenges-limitation-and-future-work"></a>Challenges, Limitations, and Future Work</h1>
    <p>There are numerous challenges in this project. Most notably is the imbalance of the training data, as the majority of the data
        are obtained by extracting introns from annotation, this makes the majority of the train-set "positive". This causes a huge
        problem at the beginning, although we dampen it with the generation of false data, the ration of positive vs negative is still
        around 4:1, a better model could be built with the generation of more false introns, presumably sets accumulated by annotators
        or a more comprehensive simulation of introns using the method utilised in this project.</p>
    <p>The performance of the machine learning model is limited to the training data, although recount3 is the most comprehensive dataset available to this data,
        in the future, model should be retrained and adjusted in accordance to the newer data.</p>
    <p>ION is built on many experimental and empirical data, like recount3 score, repeat regions, and conservation scores. On the other hand, there are
        tools that predicts introns using the sequence alone, such as SpliceAI and SPLAM. Future work could expan on integrating both sequence-based
        intron prediction and experimental data. Additionally, the recent development in protein structure predict might allow us to incorporate structural
        prediction of the actual protein (analysis the legitimacy of introns using the final structure of the protein).</p>
    <h1 id="-a-name-conclusion-a-conclusion"><a target="blank" class="anchor" id="conclusion"></a>Conclusion</h1>
    <p>We have successfully developed a model ION that predicts the legitimacy of an intron. The performance of ION is comparable
        to deep learning methods such as SpliceAI and SPLAM, while still being interpretable. This would allow annotators and users
        to use this program to evaluate introns and understand the decision behind it. Many improvements could be make to improve
        this model including generating higher quality &quot;negative&quot; introns and further tuning and experimenting with other features and models.</p>
    <h1 id="-a-name-remarks-a-acknowledgements-and-remarks"><a target="blank" class="anchor" id="remarks"></a>Acknowledgements and Remarks</h1>
    <p>I am truly grateful for the unwavering support I&#39;ve received throughout the course of this project from the mentors.
        Despite an initial slow start, my mentors have been incredibly supportive, providing invaluable guidance
        through daily communication and during our regular meetings.</p>
    <p>From the moment I was accepted into the program to its near completion, I have been continually awed and humbled by the
        wealth of knowledge and skills I&#39;ve gained through this experience. My primary focus has traditionally been in the realm
        of computational bio/chemistry, which made the opportunity to delve into an unfamiliar domain through this
        project all the more exhilarating for me.</p>

</div>

</body>
<script>
    // Get the button
    let mybutton = document.getElementById("myBtn");

    // When the user scrolls down 20px from the top of the document, show the button
    window.onscroll = function() {scrollFunction()};

    function scrollFunction() {
        if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
            mybutton.style.display = "block";
        } else {
            mybutton.style.display = "none";
        }
    }

    // When the user clicks on the button, scroll to the top of the document
    function topFunction() {
        document.body.scrollTop = 0;
        document.documentElement.scrollTop = 0;
    }
</script>

</html>